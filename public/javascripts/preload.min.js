(function(){document.addEventListener("DOMContentLoaded",function(){var g=document.querySelector("form"),h=g.querySelector("button"),l=g.querySelector('label[for="image_uploads"]'),k=g.querySelector("input#image_uploads"),e=document.querySelector(".preview"),p=["image/jpeg","image/pjpeg","image/png"],f=!1,r=function(){if(!f){f=!0;for(l.classList.remove("active");e.firstChild;)e.removeChild(e.firstChild);var a=k.files;console.log(a);if(0===a.length)a=document.createElement("p"),a.textContent="No files currently selected for upload",
e.appendChild(a),h.setAttribute("disabled",!0);else{var q=document.createElement("ol");e.appendChild(q);for(var c=0;c<a.length;c++){var m=document.createElement("li"),n=document.createElement("p"),b;a:{for(b=0;b<p.length;b++)if(a[c].type===p[b]){b=!0;break a}b=!1}if(b){b=n;var t='File name "'+a[c].name+'", file size ';var d=a[c].size;d=1024>d?d+"bytes":1024<=d&&1048576>d?(d/1024).toFixed(1)+"KB":1048576<=d?(d/1048576).toFixed(1)+"MB":void 0;b.textContent=t+d+".";b=document.createElement("img");b.src=
window.URL.createObjectURL(a[c]);b.height=64;m.appendChild(b)}else n.textContent="File name "+a[c].name+": Not a valid file type. Update your selection.";m.appendChild(n);q.appendChild(m);h.removeAttribute("disabled")}}f=!1}};k.addEventListener("click",function(){k.value="";l.classList.add("active");document.body.onfocus=function(){setTimeout(function(){r();document.body.onfocus=null},100)}});k.addEventListener("change",r);h.addEventListener("click",function(a){a.preventDefault();f||(f=!0,h.classList.add("active"),
l.setAttribute("disabled",!0),a=new FormData(g),fetch("/upload",{method:"POST",body:a}).then(function(a){return a.json()}).then(function(a){var c=a.message;"successful"===a.status?fetch("/check/"+c,{method:"POST"}).then(function(a){return a.json()}).then(function(a){var e=a.message,b=a.code;"successful"===a.status?window.location.pathname=e:"something_got_wrong"===b?fetch("/check/"+c,{method:"POST"}).then(function(a){return a.json()}).then(function(a){var b=a.message;"successful"===a.status?window.location.pathname=
b:console.error(a)}).catch(function(a){return console.error("Error:",a)}):console.error(a)}).catch(function(a){return console.error(a)}):console.error(a)}).catch(function(a){return console.error(a)}))})})})();
